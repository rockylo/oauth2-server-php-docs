<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="Content-Language" content="en-us" />
  <meta http-equiv="imagetoolbar" content="false" />
  <meta name="MSSmartTagsPreventParsing" content="true" />

  <title>Grant Types | OAuth2 Server PHP</title>

  <link rel="alternate" type="application/atom+xml" title="API Changes" href="changes.atom" />
  <link href="/oauth2-server-php-docs/css/reset.css" rel="stylesheet" type="text/css" />
  <link href="/oauth2-server-php-docs/css/960.css" rel="stylesheet" type="text/css" />
  <link href="/oauth2-server-php-docs/css/uv_active4d.css" rel="stylesheet" type="text/css" />
  <link href="/oauth2-server-php-docs/shared/css/documentation.css" media="screen" rel="stylesheet" type="text/css">
  <link href="/oauth2-server-php-docs/shared/css/pygments.css" media="screen" rel="stylesheet" type="text/css">
  <link href="/oauth2-server-php-docs/css/coderay.css" rel="stylesheet" type="text/css" />

  <script src="/oauth2-server-php-docs/shared/js/jquery.js" type="text/javascript"></script>
  <script src="/oauth2-server-php-docs/shared/js/documentation.js" type="text/javascript"></script>
</head>
<body class="api">
    <div id="header-wrapper">
      <div id="header">
        <div>
          <a class="logo" href="/oauth2-server-php-docs/">
            <img src="/oauth2-server-php-docs/images/oauth2-banner.png"/>
          </a>
          <ul class="nav">
            <li><a href="https://github.com/bshaffer/oauth2-server-php/blob/develop/CHANGELOG.md">Changes</a></li>
            <!-- <li><a href="/oauth2-server-php-docs/changes.atom">
              <img src="/oauth2-server-php-docs/images/feed-icon-28x28.png" width="16" height="16" alt="GitHub API Changes Feed" />
            </a></li> -->
          </ul>
        </div>
      </div><!-- #header -->
    </div><!-- #header-wrapper -->

    <div id="wrapper">
      <div class="content">
    
<h1 id="grant-types">Grant Types</h1>

<p>There are many supported grant types in the OAuth2 specification, and this library allows for the addition of custom grant types as well.
Supported grant types are as follows:</p>

<h3 id="authorization-codegrant-typesauthorization-code"><a href="../../grant-types/authorization-code/">Authorization Code</a></h3>

<p>The <code>Authorization Code</code> grant type is the most common OAuth2.0 flow.  It implements <strong>3-Legged OAuth</strong> and involves the user granting the
client an authorization code, which can be exchanged for an Access Token. Click the <a href="http://brentertainment.com/oauth2/">Live Demo</a> to see
this grant type in action.</p>

<h3 id="resource-owner-password-credentialsgrant-typesuser-credentials"><a href="../../grant-types/user-credentials/">Resource Owner Password Credentials</a></h3>

<p>A Resource Owner’s username and password are submitted as part of the request, and a token is issued upon successful authentication.</p>

<div class="code-container">
<div class="langspec">Json</div>
<div class="CodeRay"><div class="code"><div class="CodeRay"><div class="code"><pre class="highlight"><code class="language-json"><span class="error">$</span> <span class="error">c</span><span class="error">u</span><span class="error">r</span><span class="error">l</span> <span class="error">-</span><span class="error">u</span> <span class="error">t</span><span class="error">e</span><span class="error">s</span><span class="error">t</span><span class="error">c</span><span class="error">l</span><span class="error">i</span><span class="error">e</span><span class="error">n</span><span class="error">t</span>:<span class="error">t</span><span class="error">e</span><span class="error">s</span><span class="error">t</span><span class="error">p</span><span class="error">a</span><span class="error">s</span><span class="error">s</span> <span class="string"><span class="delimiter">"</span><span class="content">http://localhost/token.php</span><span class="delimiter">"</span></span> <span class="error">-</span><span class="error">d</span> <span class="error">'</span><span class="error">g</span><span class="error">r</span><span class="error">a</span><span class="error">n</span><span class="error">t</span><span class="error">_</span><span class="error">t</span><span class="error">y</span><span class="error">p</span><span class="error">e</span><span class="error">=</span><span class="error">p</span><span class="error">a</span><span class="error">s</span><span class="error">s</span><span class="error">w</span><span class="error">o</span><span class="error">r</span><span class="error">d</span><span class="error">&amp;</span><span class="error">u</span><span class="error">s</span><span class="error">e</span><span class="error">r</span><span class="error">n</span><span class="error">a</span><span class="error">m</span><span class="error">e</span><span class="error">=</span><span class="error">s</span><span class="error">o</span><span class="error">m</span><span class="error">e</span><span class="error">u</span><span class="error">s</span><span class="error">e</span><span class="error">r</span><span class="error">&amp;</span><span class="error">p</span><span class="error">a</span><span class="error">s</span><span class="error">s</span><span class="error">w</span><span class="error">o</span><span class="error">r</span><span class="error">d</span><span class="error">=</span><span class="error">s</span><span class="error">o</span><span class="error">m</span><span class="error">e</span><span class="error">p</span><span class="error">a</span><span class="error">s</span><span class="error">s</span><span class="error">w</span><span class="error">o</span><span class="error">r</span><span class="error">d</span><span class="error">'</span>
{<span class="key"><span class="delimiter">"</span><span class="content">access_token</span><span class="delimiter">"</span></span>:<span class="string"><span class="delimiter">"</span><span class="content">206c80413b9a96c1312cc346b7d2517b84463edd</span><span class="delimiter">"</span></span>,<span class="key"><span class="delimiter">"</span><span class="content">expires_in</span><span class="delimiter">"</span></span>:<span class="integer">3600</span>,<span class="key"><span class="delimiter">"</span><span class="content">token_type</span><span class="delimiter">"</span></span>:<span class="string"><span class="delimiter">"</span><span class="content">bearer</span><span class="delimiter">"</span></span>,<span class="key"><span class="delimiter">"</span><span class="content">scope</span><span class="delimiter">"</span></span>:<span class="value">null</span>}</code></pre></div></div></div></div>
</div>
<blockquote>

</blockquote>

<h3 id="client-credentialsgrant-typesclient-credentials"><a href="../../grant-types/client-credentials/">Client Credentials</a></h3>

<p>The client uses their credentials to retrieve an access token directly, which allows access to resources under the client’s control</p>

<div class="code-container">
<div class="langspec">Json</div>
<div class="CodeRay"><div class="code"><div class="CodeRay"><div class="code"><pre class="highlight"><code class="language-json"><span class="error">$</span> <span class="error">c</span><span class="error">u</span><span class="error">r</span><span class="error">l</span> <span class="error">-</span><span class="error">u</span> <span class="error">t</span><span class="error">e</span><span class="error">s</span><span class="error">t</span><span class="error">c</span><span class="error">l</span><span class="error">i</span><span class="error">e</span><span class="error">n</span><span class="error">t</span>:<span class="error">t</span><span class="error">e</span><span class="error">s</span><span class="error">t</span><span class="error">p</span><span class="error">a</span><span class="error">s</span><span class="error">s</span> <span class="string"><span class="delimiter">"</span><span class="content">http://localhost/token.php</span><span class="delimiter">"</span></span> <span class="error">-</span><span class="error">d</span> <span class="error">'</span><span class="error">g</span><span class="error">r</span><span class="error">a</span><span class="error">n</span><span class="error">t</span><span class="error">_</span><span class="error">t</span><span class="error">y</span><span class="error">p</span><span class="error">e</span><span class="error">=</span><span class="error">c</span><span class="error">l</span><span class="error">i</span><span class="error">e</span><span class="error">n</span><span class="error">t</span><span class="error">_</span><span class="error">c</span><span class="error">r</span><span class="error">e</span><span class="error">d</span><span class="error">e</span><span class="error">n</span><span class="error">t</span><span class="error">i</span><span class="error">a</span><span class="error">l</span><span class="error">s</span><span class="error">'</span>
{<span class="key"><span class="delimiter">"</span><span class="content">access_token</span><span class="delimiter">"</span></span>:<span class="string"><span class="delimiter">"</span><span class="content">6f05ad622a3d32a5a81aee5d73a5826adb8cbf63</span><span class="delimiter">"</span></span>,<span class="key"><span class="delimiter">"</span><span class="content">expires_in</span><span class="delimiter">"</span></span>:<span class="integer">3600</span>,<span class="key"><span class="delimiter">"</span><span class="content">token_type</span><span class="delimiter">"</span></span>:<span class="string"><span class="delimiter">"</span><span class="content">bearer</span><span class="delimiter">"</span></span>,<span class="key"><span class="delimiter">"</span><span class="content">scope</span><span class="delimiter">"</span></span>:<span class="value">null</span>}</code></pre></div></div></div></div>
</div>
<blockquote>

</blockquote>

<h3 id="refresh-tokengrant-typesrefresh-token"><a href="../../grant-types/refresh-token/">Refresh Token</a></h3>

<p>The client can submit a refresh token and recieve a new access token if the access token had expired.</p>

<div class="code-container">
<div class="langspec">Json</div>
<div class="CodeRay"><div class="code"><div class="CodeRay"><div class="code"><pre class="highlight"><code class="language-json"><span class="error">$</span> <span class="error">c</span><span class="error">u</span><span class="error">r</span><span class="error">l</span> <span class="error">-</span><span class="error">u</span> <span class="error">t</span><span class="error">e</span><span class="error">s</span><span class="error">t</span><span class="error">c</span><span class="error">l</span><span class="error">i</span><span class="error">e</span><span class="error">n</span><span class="error">t</span>:<span class="error">t</span><span class="error">e</span><span class="error">s</span><span class="error">t</span><span class="error">p</span><span class="error">a</span><span class="error">s</span><span class="error">s</span> <span class="string"><span class="delimiter">"</span><span class="content">http://localhost/token.php</span><span class="delimiter">"</span></span> <span class="error">-</span><span class="error">d</span> <span class="error">'</span><span class="error">g</span><span class="error">r</span><span class="error">a</span><span class="error">n</span><span class="error">t</span><span class="error">_</span><span class="error">t</span><span class="error">y</span><span class="error">p</span><span class="error">e</span><span class="error">=</span><span class="error">r</span><span class="error">e</span><span class="error">f</span><span class="error">r</span><span class="error">e</span><span class="error">s</span><span class="error">h</span><span class="error">_</span><span class="error">t</span><span class="error">o</span><span class="error">k</span><span class="error">e</span><span class="error">n</span><span class="error">&amp;</span><span class="error">r</span><span class="error">e</span><span class="error">f</span><span class="error">r</span><span class="error">e</span><span class="error">s</span><span class="error">h</span><span class="error">_</span><span class="error">t</span><span class="error">o</span><span class="error">k</span><span class="error">e</span><span class="error">n</span><span class="error">=</span><span class="error">c</span><span class="integer">54</span><span class="error">a</span><span class="error">d</span><span class="error">c</span><span class="error">f</span><span class="error">d</span><span class="error">b</span><span class="integer">1</span><span class="error">d</span><span class="integer">99</span><span class="error">d</span><span class="integer">10</span><span class="error">b</span><span class="error">e</span><span class="integer">3</span><span class="error">b</span><span class="error">e</span><span class="integer">3</span><span class="error">b</span><span class="integer">77</span><span class="error">e</span><span class="error">c</span><span class="integer">32</span><span class="error">a</span><span class="float">2e402</span><span class="error">e</span><span class="error">f</span><span class="float">7e3</span><span class="error">'</span>
{<span class="key"><span class="delimiter">"</span><span class="content">access_token</span><span class="delimiter">"</span></span>:<span class="string"><span class="delimiter">"</span><span class="content">0e9d02499fe06762ecaafb9cfbb506676631dcfd</span><span class="delimiter">"</span></span>,<span class="key"><span class="delimiter">"</span><span class="content">expires_in</span><span class="delimiter">"</span></span>:<span class="integer">3600</span>,<span class="key"><span class="delimiter">"</span><span class="content">token_type</span><span class="delimiter">"</span></span>:<span class="string"><span class="delimiter">"</span><span class="content">bearer</span><span class="delimiter">"</span></span>,<span class="key"><span class="delimiter">"</span><span class="content">scope</span><span class="delimiter">"</span></span>:<span class="value">null</span>}</code></pre></div></div></div></div>
</div>
<blockquote>

</blockquote>

<h3 id="implicitgrant-typesimplicit"><a href="../../grant-types/implicit/">Implicit</a></h3>

<p>This is similar to the <code>Authorization Code</code> Grant Type above, but rather than an Authorization Code being returned from the authorization
request, a token is retured to the client.  This is most common for client-side devices (i.e. mobile) where the Client Credentials cannot
be stored securely.</p>

<p>Use the <code>Implicit</code> Grant Type by setting the <code>allow_implicit</code> option to true for the <code>authorize</code> endpoint:</p>

<div class="code-container">
<div class="langspec">Php</div>
<div class="CodeRay"><div class="code"><div class="CodeRay"><div class="code"><pre class="highlight"><code class="language-php"><span class="local-variable">$storage</span> = <span class="keyword">new</span> <span class="constant">OAuth2</span>\<span class="constant">Storage</span>\<span class="constant">Pdo</span>(<span class="predefined">array</span>(<span class="string"><span class="delimiter">'</span><span class="content">dsn</span><span class="delimiter">'</span></span> =&gt; <span class="local-variable">$dsn</span>, <span class="string"><span class="delimiter">'</span><span class="content">username</span><span class="delimiter">'</span></span> =&gt; <span class="local-variable">$username</span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span> =&gt; <span class="local-variable">$password</span>));
<span class="local-variable">$server</span> = <span class="keyword">new</span> <span class="constant">OAuth2</span>\<span class="constant">Server</span>(<span class="local-variable">$storage</span>, <span class="predefined">array</span>(<span class="string"><span class="delimiter">'</span><span class="content">allow_implicit</span><span class="delimiter">'</span></span> =&gt; <span class="predefined-constant">true</span>));

<span class="local-variable">$server</span>-&gt;handleAuthorizeRequest(<span class="constant">OAuth2</span>\<span class="constant">Request</span>::createFromGlobals())-&gt;send();</code></pre></div></div></div></div>
</div>
<blockquote>
  <p>It is important to note this is not added as a <code>Grant Type</code> class because the implicit grant type is requested using the <code>authorize</code> endpoint rather than the <code>token</code> endpoint.</p>
</blockquote>

<h3 id="jwt-bearergrant-typesjwt-bearer"><a href="../../grant-types/jwt-bearer/">JWT Bearer</a></h3>

<p>The client can submit a JWT (JSON Web Token) in a request to the token endpoint. An access token (without a refresh token) is then returned directly.</p>

<h3 id="extension-granthttptoolsietforghtmlrfc6749section-45"><a href="http://tools.ietf.org/html/rfc6749#section-4.5">Extension Grant</a></h3>

<p>Create your own grant type by implementing the <code>OAuth2\GrantType\GrantTypeInterface</code> and adding it to the OAuth2 Server object.  The <code>JWT Bearer</code>
Grant Type above is an example of this.</p>

<h2 id="multiple-grant-types">Multiple Grant Types</h2>

<p>If you want to support more than one grant type it is possible to add more when the Server object is created:</p>

<div class="code-container">
<div class="langspec">Php</div>
<div class="CodeRay"><div class="code"><div class="CodeRay"><div class="code"><pre class="highlight"><code class="language-php"><span class="local-variable">$server</span>-&gt;addGrantType(<span class="keyword">new</span> <span class="constant">OAuth2</span>\<span class="constant">GrantType</span>\<span class="constant">UserCredentials</span>(<span class="local-variable">$storage</span>));
<span class="local-variable">$server</span>-&gt;addGrantType(<span class="keyword">new</span> <span class="constant">OAuth2</span>\<span class="constant">GrantType</span>\<span class="constant">RefreshToken</span>(<span class="local-variable">$storage</span>));
<span class="local-variable">$server</span>-&gt;addGrantType(<span class="keyword">new</span> <span class="constant">OAuth2</span>\<span class="constant">GrantType</span>\<span class="constant">AuthorizationCode</span>(<span class="local-variable">$storage</span>));</code></pre></div></div></div></div>
</div>
<p>## Restricting Grant Types to Clients
The grant type(s) available to a client are controlled by a combination of the <code>grant_type</code> field in the client storage, and the grant types made available within the authorization server.</p>

<p>When the client has a list of grant types configured alongside it, the client is restricted to using only those grant types. When there are no grant types configured, the client is not restricted in what grant types it may use, it is able to use all grant types available within the authorization server.</p>
      </div>

    <div id="js-sidebar" class="sidebar-shell">
      <div class="js-toggle-list sidebar-module expandable">
        <ul>
          <li class="js-topic">
            <h3><a href="#" class="js-expand-btn collapsed">&nbsp;</a><a href="/oauth2-server-php-docs/">Overview</a></h3>
            <ul class="js-guides">
              <li><a href="/oauth2-server-php-docs/">Get Started</a></li>
              <li><a href="/oauth2-server-php-docs/overview/main-concepts/">Main Concepts</a></li>
              <li><a href="/oauth2-server-php-docs/overview/grant-types/">Grant Types</a></li>
              <li><a href="/oauth2-server-php-docs/overview/controllers/">Controllers</a></li>
              <li><a href="/oauth2-server-php-docs/overview/storage/">Storage</a></li>
              <li><a href="/oauth2-server-php-docs/overview/response/">Request and Response</a></li>
              <li><a href="/oauth2-server-php-docs/overview/scope/">Scope</a></li>
              <li><a href="/oauth2-server-php-docs/overview/userid/">User ID</a></li>
              <li><a href="/oauth2-server-php-docs/overview/jwt-access-tokens/">JWT Access Tokens</a></li>
            </ul>
          </li>
          <li class="js-topic">
            <h3><a href="#" class="js-expand-btn collapsed">&nbsp;</a><a href="/oauth2-server-php-docs/grant-types/authorization-code/">Grant Types</a></h3>
            <ul class="js-guides">
              <li><a href="/oauth2-server-php-docs/grant-types/authorization-code/">Authorization Code</a></li>
              <li><a href="/oauth2-server-php-docs/grant-types/implicit/">Implicit</a></li>
              <li><a href="/oauth2-server-php-docs/grant-types/user-credentials/">User Credentials</a></li>
              <li><a href="/oauth2-server-php-docs/grant-types/client-credentials/">Client Credentials</a></li>
              <li><a href="/oauth2-server-php-docs/grant-types/refresh-token/">Refresh Token</a></li>
              <li><a href="/oauth2-server-php-docs/grant-types/jwt-bearer/">JWT Bearer</a></li>
            </ul>
          </li>
          <li class="js-topic">
            <h3><a href="#" class="js-expand-btn collapsed">&nbsp;</a><a href="/oauth2-server-php-docs/controllers/authorize">Controllers</a></h3>
            <ul class="js-guides">
              <li><a href="/oauth2-server-php-docs/controllers/authorize/">Authorize</a></li>
              <li><a href="/oauth2-server-php-docs/controllers/resource/">Resource</a></li>
              <li><a href="/oauth2-server-php-docs/controllers/token/">Token</a></li>
            </ul>
          </li>
          <li class="js-topic">
            <h3><a href="#" class="js-expand-btn collapsed">&nbsp;</a><a href="/oauth2-server-php-docs/storage/pdo/">Storage</a></h3>
            <ul class="js-guides">
              <li><a href="/oauth2-server-php-docs/storage/pdo/">PDO</a></li>
              <li><a href="/oauth2-server-php-docs/storage/mongo/">Mongo</a></li>
              <li><a href="/oauth2-server-php-docs/storage/redis/">Redis</a></li>
              <li><a href="/oauth2-server-php-docs/storage/cassandra/">Cassandra</a></li>
              <li><a href="/oauth2-server-php-docs/storage/dynamodb/">DynamoDB</a></li>
              <li><a href="/oauth2-server-php-docs/storage/custom/">Custom Storage</a></li>
              <li><a href="/oauth2-server-php-docs/storage/multiple/">Using Multiple Storages</a></li>
            </ul>
          </li>
          <li class="js-topic">
            <h3><a href="#" class="js-expand-btn collapsed">&nbsp;</a><a href="/oauth2-server-php-docs/cookbook/">Cookbook</a></h3>
            <ul class="js-guides">
              <li><a href="/oauth2-server-php-docs/cookbook/">Step-By-Step Walkthrough</a></li>
              <li><a href="/oauth2-server-php-docs/cookbook/google-playground/">Google Playground</a></li>
              <li><a href="/oauth2-server-php-docs/cookbook/drupal/">Drupal</a></li>
              <li><a href="/oauth2-server-php-docs/cookbook/symfony2/">Symfony2</a></li>
              <li><a href="/oauth2-server-php-docs/cookbook/silex/">Silex</a></li>
              <li><a href="/oauth2-server-php-docs/cookbook/zend-framework/">Zend Framework</a></li>
              <li><a href="/oauth2-server-php-docs/cookbook/laravel/">Laravel</a></li>
              <li><a href="/oauth2-server-php-docs/cookbook/doctrine/">Doctrine</a></li>
              <li><a href="/oauth2-server-php-docs/cookbook/doctrine2/">Doctrine2</a></li>
              <li><a href="/oauth2-server-php-docs/cookbook/cakephp/">CakePHP</a></li>
              <li><a href="/oauth2-server-php-docs/cookbook/restler/">Restler</a></li>
              <!-- <li><a href="/oauth2-server-php-docs/cookbook/doctrine2/">Doctrine2</a></li>
              <li><a href="/oauth2-server-php-docs/cookbook/symfony/">Symfony 1.4</a></li> -->
            </ul>
          </li>
        </ul>
      </div> <!-- /sidebar-module -->
      <div class="sidebar-module">
        <p>This project is open source. Please help us by forking the project and adding to it.</p>
      </div>
    </div><!-- /sidebar-shell -->

    </div><!-- #wrapper -->

    <div id="footer" >
      <div class="upper_footer">
        <div class="footer_inner clearfix">

        </div><!-- /.site -->
      </div><!-- /.upper_footer -->

      <div class="lower_footer">
        <div class="footer_inner clearfix">
            <div id="legal">
              <p>&copy; <span id="year">year</span> Brent Shaffer. All rights reserved.</p>
            </div><!-- /#legal or /#legal_ie-->
        </div><!-- /.site -->
      </div><!-- /.lower_footer -->
    </div><!-- /#footer -->
    <a href="https://github.com/bshaffer/oauth2-server-php-docs"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"></a>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-11590669-6', 'bshaffer.github.io');
      ga('send', 'pageview');

      function trackOutboundLink(link, category, action) {
        try {
          _gaq.push(['_trackEvent', category , action]);
        } catch(err){}

        setTimeout(function() {
          document.location.href = link.href;
        }, 100);
      }
    </script>
</body>
</html>
