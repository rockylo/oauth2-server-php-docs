<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="Content-Language" content="en-us" />
  <meta http-equiv="imagetoolbar" content="false" />
  <meta name="MSSmartTagsPreventParsing" content="true" />

  <title>Custom Storage | OAuth2 Server PHP</title>

  <link rel="alternate" type="application/atom+xml" title="API Changes" href="changes.atom" />
  <link href="/oauth2-server-php-docs/css/reset.css" rel="stylesheet" type="text/css" />
  <link href="/oauth2-server-php-docs/css/960.css" rel="stylesheet" type="text/css" />
  <link href="/oauth2-server-php-docs/css/uv_active4d.css" rel="stylesheet" type="text/css" />
  <link href="/oauth2-server-php-docs/shared/css/documentation.css" media="screen" rel="stylesheet" type="text/css">
  <link href="/oauth2-server-php-docs/shared/css/pygments.css" media="screen" rel="stylesheet" type="text/css">
  <link href="/oauth2-server-php-docs/css/coderay.css" rel="stylesheet" type="text/css" />

  <script src="/oauth2-server-php-docs/shared/js/jquery.js" type="text/javascript"></script>
  <script src="/oauth2-server-php-docs/shared/js/documentation.js" type="text/javascript"></script>
</head>
<body class="api">
    <div id="header-wrapper">
      <div id="header">
        <div>
          <a class="logo" href="/oauth2-server-php-docs/">
            <img src="/oauth2-server-php-docs/images/oauth2-banner.png"/>
          </a>
          <ul class="nav">
            <li><a href="https://github.com/bshaffer/oauth2-server-php/blob/develop/CHANGELOG.md">Changes</a></li>
            <!-- <li><a href="/oauth2-server-php-docs/changes.atom">
              <img src="/oauth2-server-php-docs/images/feed-icon-28x28.png" width="16" height="16" alt="GitHub API Changes Feed" />
            </a></li> -->
          </ul>
        </div>
      </div><!-- #header -->
    </div><!-- #header-wrapper -->

    <div id="wrapper">
      <div class="content">
    
<h1 id="custom-storage">Custom Storage</h1>

<h2 id="overview">Overview</h2>

<p>A great advantage to using this library is the ease of customizing your
own storage. If one of the built-in storage objects does not fit your needs,
you can implement one or more of the interfaces below to obtain custom storage
functionality.</p>

<h2 id="how-to-customize-storage">How to Customize Storage</h2>

<p>First, find out which storage interfaces you want to implement. As a minimum, every
OAuth2 server requires storage objects implementing <code>AccessTokenInterface</code> and
<code>ClientCredentialsInterface</code>, so if you cannot store these using one of the built-in
storage classes, your custom storage can start with these. After that, you’ll want to
implement additional interfaces based on your <a href="../../overview/grant-types/">Grant Types</a>.
For instance, if you want your server to support the <code>authorization_code</code> grant type
(most common), and you want your custom storage to do it, you’ll need to implement
<code>AuthorizationCodeInterface</code> on your storage object(s) as well.</p>

<p>The term “implement” refers to the class declaration in your custom storage
PHP class. For instance, to use custom storage for access tokens, clients, and the
authorization code grant type, your class will look something like this:</p>

<div class="code-container">
<div class="langspec">Php</div>
<div class="CodeRay"><div class="code"><div class="CodeRay"><div class="code"><pre class="highlight"><code class="language-php"><span class="keyword">class</span> <span class="class">MyCustomStorage</span> <span class="keyword">implements</span> <span class="constant">OAuth2</span>\<span class="constant">Storage</span>\<span class="constant">AccessTokenInterface</span>,
<span class="constant">OAuth2</span>\<span class="constant">Storage</span>\<span class="constant">ClientCredentialsInterface</span>, <span class="constant">OAuth2</span>\<span class="constant">Storage</span>\<span class="constant">AuthorizationCodeInterface</span>
{
    <span class="comment">// method implementation here...</span>
}</code></pre></div></div></div></div>
</div>
<p>Once this is done, you will need to write all the methods that those interfaces require.
For instance, <code>ClientCredentialsInterface</code> specifies the method <code>getClientDetails</code>,
which accepts a <code>$client_id</code> parameter and returns an array of client data.</p>

<p>From there, you’ll pass this new storage object into the server class:</p>

<div class="code-container">
<div class="langspec">Php</div>
<div class="CodeRay"><div class="code"><div class="CodeRay"><div class="code"><pre class="highlight"><code class="language-php"><span class="local-variable">$customStorage</span> = <span class="keyword">new</span> <span class="constant">MyCustomStorage</span>();
<span class="local-variable">$server</span> = <span class="keyword">new</span> <span class="constant">OAuth2</span>\<span class="constant">Server</span>(<span class="local-variable">$customStorage</span>);</code></pre></div></div></div></div>
</div>
<p>Don’t know what methods you need? No problem, just pop open the interface classes and <a href="https://github.com/bshaffer/oauth2-server-php/tree/develop/src/OAuth2/Storage">take
a look</a>! If
this isn’t your style, PHP throws a helpful error message to let you know the
methods your class still needs to implement, if it’s missing them.</p>

<p>All of the storage objects included in this library are no different from a “Custom Storage”
object.  The only real difference is that they’re included in the library by default, and
they implement <strong>all</strong> the interfaces (yours doesn’t have to implement all the storage
interfaces, just the ones you want to customize).</p>

<p>See the list of interfaces below for all possible storage interfaces, and check out the
<a href="https://github.com/bshaffer/oauth2-server-php/blob/develop/src/OAuth2/Storage/Cassandra.php">Cassandra Storage</a>
class for an example of a storage object implemented for a “custom” purpose - to interface
with the Cassandra storage engine.</p>

<h2 id="interfaces">Interfaces</h2>

<p><strong><a href="https://github.com/bshaffer/oauth2-server-php/blob/develop/src/OAuth2/Storage/AccessTokenInterface.php">Access Token Interface</a></strong></p>

<p>For implementing basic Access Tokens. This is required for the
<a href="../../controllers/token/">Token Controller</a>, unless
<a href="../../overview/jwt-access-tokens">JWT Access Tokens</a> are used instead.</p>

<p><em>id: “access_token”</em></p>

<p><strong><a href="https://github.com/bshaffer/oauth2-server-php/blob/develop/src/OAuth2/Storage/ClientInterface.php">Client Interface</a></strong></p>

<p>Required for the <a href="../../controllers/token/">Token Controller</a>
and <a href="../../controllers/authorize/">Authorize Controller</a>, and
is used to gather information about the client making the request.</p>

<p><em>id: “client”</em></p>

<p><strong><a href="https://github.com/bshaffer/oauth2-server-php/blob/develop/src/OAuth2/Storage/ClientCredentialsInterface.php">Client Credentials Interface</a></strong></p>

<p>For validating a client’s credentials. This is required for all requests
to the <a href="../../controllers/token/">Token Controller</a>, in order to validate
the client making the request.</p>

<p><em>id: “client_credentials”</em></p>

<p><strong><a href="https://github.com/bshaffer/oauth2-server-php/blob/develop/src/OAuth2/Storage/AuthorizationCodeInterface.php">Authorization Code Interface</a></strong></p>

<p>For implementing the <a href="../../grant-type/authorization-code">Authorization Code Grant Type</a></p>

<p><em>id: “authorization_code”</em></p>

<p><strong><a href="https://github.com/bshaffer/oauth2-server-php/blob/develop/src/OAuth2/Storage/RefreshTokenInterface.php">Refresh Token Interface</a></strong></p>

<p>For implementing the <a href="../../grant-type/refresh-token/">Refresh Token Grant Type</a>.</p>

<p><em>id: “refresh_token”</em></p>

<p><strong><a href="https://github.com/bshaffer/oauth2-server-php/blob/develop/src/OAuth2/Storage/UserCredentialsInterface.php">User Credentials Interface</a></strong></p>

<p>For implementing the <a href="../../grant-type/user-credentials">User Credentials Grant Type</a>.</p>

<p><em>id: “user_credentials”</em></p>

<p><strong><a href="https://github.com/bshaffer/oauth2-server-php/blob/develop/src/OAuth2/Storage/JwtBearerInterface.php">JWT Bearer Interface</a></strong></p>

<p>Required for the <a href="../../grant-type/jwt-bearer">JWT Bearer Grant Type</a>.</p>

<p><em>id: “jwt_bearer”</em></p>

<p><strong><a href="https://github.com/bshaffer/oauth2-server-php/blob/develop/src/OAuth2/Storage/ScopeInterface.php">Scope Interface</a></strong></p>

<p>For implementing scopes using the <a href="../../overview/scope">Scope Util</a>.</p>

<p><em>id: “scope”</em></p>

<p><strong><a href="https://github.com/bshaffer/oauth2-server-php/blob/develop/src/OAuth2/Storage/PublicKeyInterface.php">Public Key Interface</a></strong></p>

<p>For implementing <a href="../../overview/jwt-access-tokens">JWT Access Token</a>.</p>

<p><em>id: “public_key”</em></p>

<p><strong><a href="https://github.com/bshaffer/oauth2-server-php/blob/develop/src/OAuth2/Storage/JwtAccessTokenInterface.php">JWT Access Token Interface</a></strong></p>

<p>An interface for using <a href="../../overview/jwt-access-tokens">JWT Access Tokens</a>.
This requires the Public Key interface (below), and is used for validating
access tokens without the use of a database system.</p>

<p><em>id: NONE</em></p>
      </div>

    <div id="js-sidebar" class="sidebar-shell">
      <div class="js-toggle-list sidebar-module expandable">
        <ul>
          <li class="js-topic">
            <h3><a href="#" class="js-expand-btn collapsed">&nbsp;</a><a href="/oauth2-server-php-docs/">Overview</a></h3>
            <ul class="js-guides">
              <li><a href="/oauth2-server-php-docs/">Get Started</a></li>
              <li><a href="/oauth2-server-php-docs/overview/main-concepts/">Main Concepts</a></li>
              <li><a href="/oauth2-server-php-docs/overview/grant-types/">Grant Types</a></li>
              <li><a href="/oauth2-server-php-docs/overview/controllers/">Controllers</a></li>
              <li><a href="/oauth2-server-php-docs/overview/storage/">Storage</a></li>
              <li><a href="/oauth2-server-php-docs/overview/response/">Request and Response</a></li>
              <li><a href="/oauth2-server-php-docs/overview/scope/">Scope</a></li>
              <li><a href="/oauth2-server-php-docs/overview/userid/">User ID</a></li>
              <li><a href="/oauth2-server-php-docs/overview/jwt-access-tokens/">JWT Access Tokens</a></li>
            </ul>
          </li>
          <li class="js-topic">
            <h3><a href="#" class="js-expand-btn collapsed">&nbsp;</a><a href="/oauth2-server-php-docs/grant-types/authorization-code/">Grant Types</a></h3>
            <ul class="js-guides">
              <li><a href="/oauth2-server-php-docs/grant-types/authorization-code/">Authorization Code</a></li>
              <li><a href="/oauth2-server-php-docs/grant-types/implicit/">Implicit</a></li>
              <li><a href="/oauth2-server-php-docs/grant-types/user-credentials/">User Credentials</a></li>
              <li><a href="/oauth2-server-php-docs/grant-types/client-credentials/">Client Credentials</a></li>
              <li><a href="/oauth2-server-php-docs/grant-types/refresh-token/">Refresh Token</a></li>
              <li><a href="/oauth2-server-php-docs/grant-types/jwt-bearer/">JWT Bearer</a></li>
            </ul>
          </li>
          <li class="js-topic">
            <h3><a href="#" class="js-expand-btn collapsed">&nbsp;</a><a href="/oauth2-server-php-docs/controllers/authorize">Controllers</a></h3>
            <ul class="js-guides">
              <li><a href="/oauth2-server-php-docs/controllers/authorize/">Authorize</a></li>
              <li><a href="/oauth2-server-php-docs/controllers/resource/">Resource</a></li>
              <li><a href="/oauth2-server-php-docs/controllers/token/">Token</a></li>
            </ul>
          </li>
          <li class="js-topic">
            <h3><a href="#" class="js-expand-btn collapsed">&nbsp;</a><a href="/oauth2-server-php-docs/storage/pdo/">Storage</a></h3>
            <ul class="js-guides">
              <li><a href="/oauth2-server-php-docs/storage/pdo/">PDO</a></li>
              <li><a href="/oauth2-server-php-docs/storage/mongo/">Mongo</a></li>
              <li><a href="/oauth2-server-php-docs/storage/redis/">Redis</a></li>
              <li><a href="/oauth2-server-php-docs/storage/cassandra/">Cassandra</a></li>
              <li><a href="/oauth2-server-php-docs/storage/dynamodb/">DynamoDB</a></li>
              <li><a href="/oauth2-server-php-docs/storage/custom/">Custom Storage</a></li>
              <li><a href="/oauth2-server-php-docs/storage/multiple/">Using Multiple Storages</a></li>
            </ul>
          </li>
          <li class="js-topic">
            <h3><a href="#" class="js-expand-btn collapsed">&nbsp;</a><a href="/oauth2-server-php-docs/cookbook/">Cookbook</a></h3>
            <ul class="js-guides">
              <li><a href="/oauth2-server-php-docs/cookbook/">Step-By-Step Walkthrough</a></li>
              <li><a href="/oauth2-server-php-docs/cookbook/google-playground/">Google Playground</a></li>
              <li><a href="/oauth2-server-php-docs/cookbook/drupal/">Drupal</a></li>
              <li><a href="/oauth2-server-php-docs/cookbook/symfony2/">Symfony2</a></li>
              <li><a href="/oauth2-server-php-docs/cookbook/silex/">Silex</a></li>
              <li><a href="/oauth2-server-php-docs/cookbook/zend-framework/">Zend Framework</a></li>
              <li><a href="/oauth2-server-php-docs/cookbook/laravel/">Laravel</a></li>
              <li><a href="/oauth2-server-php-docs/cookbook/doctrine/">Doctrine</a></li>
              <li><a href="/oauth2-server-php-docs/cookbook/doctrine2/">Doctrine2</a></li>
              <li><a href="/oauth2-server-php-docs/cookbook/cakephp/">CakePHP</a></li>
              <li><a href="/oauth2-server-php-docs/cookbook/restler/">Restler</a></li>
              <!-- <li><a href="/oauth2-server-php-docs/cookbook/doctrine2/">Doctrine2</a></li>
              <li><a href="/oauth2-server-php-docs/cookbook/symfony/">Symfony 1.4</a></li> -->
            </ul>
          </li>
        </ul>
      </div> <!-- /sidebar-module -->
      <div class="sidebar-module">
        <p>This project is open source. Please help us by forking the project and adding to it.</p>
      </div>
    </div><!-- /sidebar-shell -->

    </div><!-- #wrapper -->

    <div id="footer" >
      <div class="upper_footer">
        <div class="footer_inner clearfix">

        </div><!-- /.site -->
      </div><!-- /.upper_footer -->

      <div class="lower_footer">
        <div class="footer_inner clearfix">
            <div id="legal">
              <p>&copy; <span id="year">year</span> Brent Shaffer. All rights reserved.</p>
            </div><!-- /#legal or /#legal_ie-->
        </div><!-- /.site -->
      </div><!-- /.lower_footer -->
    </div><!-- /#footer -->
    <a href="https://github.com/bshaffer/oauth2-server-php-docs"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"></a>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-11590669-6', 'bshaffer.github.io');
      ga('send', 'pageview');

      function trackOutboundLink(link, category, action) {
        try {
          _gaq.push(['_trackEvent', category , action]);
        } catch(err){}

        setTimeout(function() {
          document.location.href = link.href;
        }, 100);
      }
    </script>
</body>
</html>
